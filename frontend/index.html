<!DOCTYPE html>
<html lang="en" data-bs-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projeto Empresa</title>
    <meta name="keywords" content="empresa empresas fornecedores fornecedor cnpj">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="//cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="./assets/css/styles.min.css">
    <link rel="stylesheet" href="./node_modules/notyf/notyf.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="shortcut icon" href="https://cdn.iconscout.com/icon/free/png-256/free-mnc-company-1956292-1650455.png"
        type="image/x-icon">
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Projeto Crud</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link link-primary" aria-current="page" href="#">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">GitHub</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Empresas</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <section class="container-fluid d-flex j-between darkbg">
        <div class="square" data-bs-toggle="modal" data-bs-target="#modalCadastro">
            <div class="text">
                <span class="span-num" id="numbers">0</span>
                <p class="superText">Fornecedores cadastrados</p>
                <span class="cadLink">Cadastre aqui</span>
                <div class="icon">
                    <span class="material-icons toRight">
                        trending_up
                    </span>
                </div>

            </div>
        </div>
        <div class="square" id="leadToCompany">
            <span class="linkLead" id="">Empresas cadastradas</span> <br>
            <span class="cadLink">Clique aqui</span>
            <div class="icon">
                <span class="material-symbols-outlined" id="companyIcon">
                    add_business
                </span>
            </div>
        </div>
        </div>
    </section>
    <section class="p-4">
        <table class="table table-success table-striped pt-5 table-hover w-100" id="tableRegisters">
            <thead class="thead table-dark">
                <tr>
                    <th scope="col">
                        Cod. Fornecedor
                    </th>
                    <th scope="col">
                        Nome
                    </th>
                    <th scope="col">
                        CPF/CNPJ
                    </th>
                    <th scope="col">
                        Data Cad.
                    </th>
                    <th scope="col">
                        #
                    </th>
                </tr>
            </thead>
            <tbody id="tcorpo">
                <!---- Conteudo Gerado via JavaScript ---->
            </tbody>
        </table>
    </section>

    <div class="modal fade" id="modalCadastro" tabindex="-1" role="dialog" aria-labelledby="modal-Cadastro"
        aria-hidden="true">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content modal-custom">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalTitleId">Cadastro de Fornecedores</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="container">
                        <div class="row p-4">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputField">Nome Fornec.:</label>
                                    <input type="text" class="form-control modalInput" id="nomeForn"
                                        placeholder="Insira o nome do Fornecedor (Required)">
                                </div>
                            </div>
                            <div class="col-sm-4 ms-1">
                                <input type="radio" id="fisicas" checked class="form-checkbox ms-2 radio" value="f"
                                    name="cpfcpnj">
                                <label for="fisicas" class="form-label">Pessoa Fisica</label>
                                <input type="radio" id="juridicas" class="form-checkbox ms-2 radio" value="p"
                                    name="cpfcpnj">
                                <label for="juridicas" class="form-label">Pessoa Jurídica</label>
                            </div>
                        </div>
                        <div class="row p-4 d-flex flex-row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="docInsertion" id="cpfLabel" class="form-label">CPF:</label>
                                    <input type="text" class="form-control modalInput" name="docInsertion"
                                        id="docInsertion" aria-describedby="documented"
                                        placeholder="Insira o CPF do Fornecedor.. (Required)">
                                </div>
                            </div>
                            <div class="col-md-2 caseFisica">
                                <div class="form-group">
                                    <label for="bornDate">Data de Nascimento:</label>
                                    <input type="text" class="form-control modalInput" id="bornDate"
                                        placeholder="00/00/0000 (Required)">
                                </div>
                            </div>
                            <div class="col-md-4 caseFisica">
                                <div class="form-group">
                                    <label for="bornDate">RG:</label>
                                    <input type="text" class="form-control d-flex modalInput" id="rgCase"
                                        placeholder="Insira o RG (Required)">
                                </div>
                            </div>
                        </div>
                        <div class="row p-4">
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label for="companiesSelect" class="form-label">Empresa Vinc.:</label>
                                    <select name="companiesSelect modalInput" id="companiesSelect"
                                        class="form-control companies">
                                        <option value="one" selected>Selecione uma Empresa</option>
                                        <!---- Opções retornadas da API-->
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="selectField">UF:</label>
                                    <select class="form-control" id="selectField">
                                        <option value="AC">Acre</option>
                                        <option value="AL">Alagoas</option>
                                        <option value="AP">Amapá</option>
                                        <option value="AM">Amazonas</option>
                                        <option value="BA">Bahia</option>
                                        <option value="CE">Ceará</option>
                                        <option value="DF">Distrito Federal</option>
                                        <option value="ES">Espírito Santo</option>
                                        <option value="GO">Goiás</option>
                                        <option value="MA">Maranhão</option>
                                        <option value="MT">Mato Grosso</option>
                                        <option value="MS">Mato Grosso do Sul</option>
                                        <option value="MG">Minas Gerais</option>
                                        <option value="PA">Pará</option>
                                        <option value="PB">Paraíba</option>
                                        <option value="PR">Paraná</option>
                                        <option value="PE">Pernambuco</option>
                                        <option value="PI">Piauí</option>
                                        <option value="RJ">Rio de Janeiro</option>
                                        <option value="RN">Rio Grande do Norte</option>
                                        <option value="RS">Rio Grande do Sul</option>
                                        <option value="RO">Rondônia</option>
                                        <option value="RR">Roraima</option>
                                        <option value="SC" selected>Santa Catarina</option>
                                        <option value="SP">São Paulo</option>
                                        <option value="SE">Sergipe</option>
                                        <option value="TO">Tocantins</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row p-3">
                            <div class="container">
                                <form>
                                    <legend class="col-form-legend col-4">Contatos:</legend>
                                    <div class="mb-3 row">
                                        <div class="col-8">
                                            <input type="text" class="form-control telephone modalInput"
                                                name="inputTel1" id="inputTel1" placeholder="Telefone 1 (Required)">
                                        </div>
                                    </div>
                                    <fieldset class="mb-3 row">
                                        <div class="col-8">
                                            <input type="text" class="form-control telephone" name="inputName"
                                                id="inputTel2" placeholder="Telefone 2">
                                        </div>
                                    </fieldset>
                                    <div class="mb-3 row">
                                        <div class="col-8">
                                            <input type="text" class="form-control celphone" id="inputTel3"
                                                placeholder="Celular">
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                        <button type="button" class="btn btn-success" id="saveBtn">Salvar</button>
                    </div>
                </div>
            </div>
        </div>
        <script src="./assets/js/script.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-maskmoney/3.0.2/jquery.maskMoney.min.js"></script>
        <script src="//cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
            crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
        <script src="./node_modules/notyf/notyf.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/gasparesganga-jquery-loading-overlay@2.1.7/dist/loadingoverlay.min.js
        "></script>
        <script>
            $(document).ready(function () {
                atualizaDadosFornecedor();
                const toggleCheck = () => {
                    if ($("#juridicas").is(":checked")) {
                        $("#rgCase").val("");
                        $("#bornDate").val("");
                        $("#cpfLabel").text("CPNJ");
                        $("#docInsertion").focus();
                        $("#docInsertion").attr("placeholder", "Insira o CPNJ do Fornecedor..  (Required)");
                        $("#docInsertion").mask('00.000.000/0000-00');
                        $(".caseFisica").addClass("d-none");

                    } else {
                        $("#cpfLabel").text("CPF");
                        $("#docInsertion").focus();
                        $("#docInsertion").attr("placeholder", "Insira o CPF do Fornecedor..  (Required)");
                        $("#docInsertion").mask('000.000.000-00');
                        $("#rgCase").mask('0.000.000');
                        let can = $(".caseFisica").hasClass("d-none") ? $(".caseFisica").removeClass("d-none") : null;
                    }
                }


                $("#leadToCompany").on('click', function () {
                    $.LoadingOverlay("show", {
                        background: "rgba(0, 0, 0, 0.8)",
                        image: `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto; background: none; display: block; shape-rendering: auto;" width="200px" height="200px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
                    <g transform="translate(50 50)">
                        <g>
                    <animateTransform attributeName="transform" type="rotate" values="0;45" keyTimes="0;1" dur="0.2s" repeatCount="indefinite"></animateTransform><path d="M29.491524206117255 -5.5 L37.491524206117255 -5.5 L37.491524206117255 5.5 L29.491524206117255 5.5 A30 30 0 0 1 24.742744050198738 16.964569457146712 L24.742744050198738 16.964569457146712 L30.399598299691117 22.621423706639092 L22.621423706639096 30.399598299691114 L16.964569457146716 24.742744050198734 A30 30 0 0 1 5.5 29.491524206117255 L5.5 29.491524206117255 L5.5 37.491524206117255 L-5.499999999999997 37.491524206117255 L-5.499999999999997 29.491524206117255 A30 30 0 0 1 -16.964569457146705 24.742744050198738 L-16.964569457146705 24.742744050198738 L-22.621423706639085 30.399598299691117 L-30.399598299691117 22.621423706639092 L-24.742744050198738 16.964569457146712 A30 30 0 0 1 -29.491524206117255 5.500000000000009 L-29.491524206117255 5.500000000000009 L-37.491524206117255 5.50000000000001 L-37.491524206117255 -5.500000000000001 L-29.491524206117255 -5.500000000000002 A30 30 0 0 1 -24.742744050198738 -16.964569457146705 L-24.742744050198738 -16.964569457146705 L-30.399598299691117 -22.621423706639085 L-22.621423706639092 -30.399598299691117 L-16.964569457146712 -24.742744050198738 A30 30 0 0 1 -5.500000000000011 -29.491524206117255 L-5.500000000000011 -29.491524206117255 L-5.500000000000012 -37.491524206117255 L5.499999999999998 -37.491524206117255 L5.5 -29.491524206117255 A30 30 0 0 1 16.964569457146702 -24.74274405019874 L16.964569457146702 -24.74274405019874 L22.62142370663908 -30.39959829969112 L30.399598299691117 -22.6214237066391 L24.742744050198738 -16.964569457146716 A30 30 0 0 1 29.491524206117255 -5.500000000000013 M0 -20A20 20 0 1 0 0 20 A20 20 0 1 0 0 -20" fill="#e15b64"></path></g></g>
                    <!-- [ldio] generated by https://loading.io/ --></svg>`,
                        imageColor: "#2cc415"
                    })
                    setTimeout(() => {
                        location.href = "./cadCompany.html"
                        $.LoadingOverlay("hide")
                    }, '1000');
                })
                $("#modalCadastro").on("show.bs.modal", function () {
                    $("#bornDate").mask('00/00/0000');
                    $(".telephone").mask('(00) 0000-0000');
                    $(".celphone").mask('(00) 00000-0000');
                    $("#docInsertion").mask('000.000.000-00');
                    $("#rgCase").mask('0.000.000');
                    $(".radio").on("change", function () {
                        toggleCheck()
                    })

                    $("#modalCadastro").on("hide.bs.modal", function () {
                        if ($("#juridicas").is(":checked")) {
                            $("#juridicas").removeAttr("checked")
                            $("#fisicas").prop("checked", true);
                            toggleCheck()
                        }
                        $(".form-control").val("");
                    })

                    $("#saveBtn").on("click", async function () {
                        try {
                            if ($("#nomeForn").val() == "") {
                                $("#nomeForn").focus();
                                throw "Nome fornecedor está vazio, verifique!";
                            }
                            else if ($("#fisicas").is(":checked")) {
                                if ($("#docInsertion").val().length < 14) {
                                    $("#docInsertion").focus();
                                    throw "CPF inserido é inválido!";
                                }
                                else if ($("#bornDate").val().length < 10) {
                                    $("#bornDate").focus();
                                    throw "Data de Nascimento inserido é inválida!";
                                }
                                else if ($("#rgCase").val().length < 9) {
                                    $("#rgCase").focus();
                                    throw "RG inserido é inválido!";
                                }
                            }
                            else if ($("#juridicas").is(":checked")) {
                                if ($("#docInsertion").val().length < 18) {
                                    $("#docInsertion").focus();
                                    throw "CNPJ inserido é inválido!";
                                }
                            }
                            if ($("#inputTel1").val().length < 11) {
                                $("#inputTel1").focus();
                                throw "Telefone Inválido! Verifique!";
                            }

                            try {
                                $.LoadingOverlay("show", {
                                    background: "rgba(0, 0, 0, 0.8)",
                                    image: `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto; background: none; display: block; shape-rendering: auto;" width="200px" height="200px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
                                        <g transform="translate(50 50)">
                                            <g>
                                        <animateTransform attributeName="transform" type="rotate" values="0;45" keyTimes="0;1" dur="0.2s" repeatCount="indefinite"></animateTransform><path d="M29.491524206117255 -5.5 L37.491524206117255 -5.5 L37.491524206117255 5.5 L29.491524206117255 5.5 A30 30 0 0 1 24.742744050198738 16.964569457146712 L24.742744050198738 16.964569457146712 L30.399598299691117 22.621423706639092 L22.621423706639096 30.399598299691114 L16.964569457146716 24.742744050198734 A30 30 0 0 1 5.5 29.491524206117255 L5.5 29.491524206117255 L5.5 37.491524206117255 L-5.499999999999997 37.491524206117255 L-5.499999999999997 29.491524206117255 A30 30 0 0 1 -16.964569457146705 24.742744050198738 L-16.964569457146705 24.742744050198738 L-22.621423706639085 30.399598299691117 L-30.399598299691117 22.621423706639092 L-24.742744050198738 16.964569457146712 A30 30 0 0 1 -29.491524206117255 5.500000000000009 L-29.491524206117255 5.500000000000009 L-37.491524206117255 5.50000000000001 L-37.491524206117255 -5.500000000000001 L-29.491524206117255 -5.500000000000002 A30 30 0 0 1 -24.742744050198738 -16.964569457146705 L-24.742744050198738 -16.964569457146705 L-30.399598299691117 -22.621423706639085 L-22.621423706639092 -30.399598299691117 L-16.964569457146712 -24.742744050198738 A30 30 0 0 1 -5.500000000000011 -29.491524206117255 L-5.500000000000011 -29.491524206117255 L-5.500000000000012 -37.491524206117255 L5.499999999999998 -37.491524206117255 L5.5 -29.491524206117255 A30 30 0 0 1 16.964569457146702 -24.74274405019874 L16.964569457146702 -24.74274405019874 L22.62142370663908 -30.39959829969112 L30.399598299691117 -22.6214237066391 L24.742744050198738 -16.964569457146716 A30 30 0 0 1 29.491524206117255 -5.500000000000013 M0 -20A20 20 0 1 0 0 20 A20 20 0 1 0 0 -20" fill="#e15b64"></path></g></g>
                                        <!-- [ldio] generated by https://loading.io/ --></svg>`,
                                    imageColor: "#2cc415"
                                })
                                const response = await criarNovoForn();
                                $.LoadingOverlay("hide");
                                switch (response) {
                                    case 201: {
                                        mensagem("Sucesso!");
                                        window.location.reload();
                                        break;
                                    } case 400: {
                                        mensagem("Algo deu errado, verifique!", 2);
                                        break;
                                    } case 406: {
                                        mensagem("Fornecedor pessoa física não pode ser vinculado com empresa do Paraná, verifique!", 2);
                                        break;
                                    }
                                    case 422: {
                                        mensagem("Data de Nascimento Inválida!", 2);
                                        $("#bornDate").focus();
                                        break;
                                    }
                                }
                            } catch (error) {
                                mensagem(error, 2)
                            }
                        } catch (err) {
                            mensagem(err, 2);
                        }

                    });

                })
            })

        </script>
</body>


</html>